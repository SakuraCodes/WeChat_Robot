# -*- coding: utf-8 -*-
import time
import random
from pathlib import Path
from datetime import datetime, timedelta

import schedule
from wxauto import WeChat
from chinese_calendar import is_workday

from select_category import rand_shop

BREAKFAST_TITLE = [
    "ğŸ‚ç§‹é«˜æ°”çˆ½ï¼Œæ¥ç¢—çƒ­æ°”è…¾è…¾çš„ğŸšå§ï¼",
    "åƒå®Œæ—©é¤ï¼Œåˆæ˜¯å…ƒæ°”æ»¡æ»¡çš„ä¸€å¤©ã€‚",
    "å¥½å¥½åƒä¸ªæ—©é¤â€¹ğŸğŸ¥¨ğŸ¥–ğŸ³â€º",
    "åˆæ˜¯çƒ­çˆ±ç”Ÿæ´»çš„ä¸€å¤©ğŸŒ",
    "ğŸ¥›ä»Šå¤©æ˜¯æ—©é¤ğ‘ğ‘™ğ‘œğ‘”ğŸ¥š",
    "ğŸ ğ“¼ğŸ¥›æ—©é¤æ—¶é—´åˆ°äº†ï¼Œè¯·é€‰æ‹©ä½ å–œæ¬¢çš„é£Ÿç‰©",
    "åœ¨æ¯ä¸€ä¸ªæ—©ä¸Šå’Œè‡ªå·±è¯´åŠ æ²¹áµáµáµğŸŒ",
    "æ—©é¤å¸¦æ¥çš„å¹¸ç¦æ„ŸâœŒï¸",
    "    ğŸ¥¯ËƒêŒ‚Ë‚ ğŸ¥¯    ",
    "â—¡Ìˆ ğŸ”† ğ™ˆğ™¤ğ™§ğ™£ğ™ğ™£ğ™œ ğŸ’",
    "ğŸŒ¿å¼€å¯å¹¸è¿çš„ä¸€å¤©â˜»",
    "ğ– šáæ—©èµ·çš„é¸Ÿå„¿ğ“…¯ËËŠË—",
    "ğŸğŸ¥¯é¢åŒ…è„‘è¢‹à«® Â´â€¢ â€¢` áƒ",
    "æ—©å…«äººáœŠ á¶»á¶»á¶»å›°",
    "æ—©èµ·çš„æ„ä¹‰æ˜¯ä¸ºäº†åƒæ—©é¤ğŸ¥¨ğŸ¥–",
]

DINNER_TITLE = [
    "*ğ‘­ğ’ğ’ğ’…ğ’Šğ’† ğ’ğ’Šğ’”ğ’•ğŸ§¾ğŸ«•ğŸŒ®",
    "æ—¥å­ä¸ç´§ä¸æ…¢ æ¯å¤©å¥½å¥½åƒé¥­",
    "ğ“Œ‰â—¯ğ“‡‹ Êœá´€ÍŸá´˜ÍŸá´˜ÍŸÊ á´‡á´ á´‡Ê€Êá´…á´€ÊÌ†Ìˆ",
    "å¸¸è¨€é“ï¼šâ€œé£Ÿé£Ÿç‰©è€…ä¸ºä¿Šæ°â€ğŸ”ğŸŸğŸ—ğŸ•",
    "Ê”â€¢Í¡Ì«â€¢Ê• Â·ğ™ƒğ™¤ğ™©ğ™¥ğ™¤ğ™©Â·ğŸ¥˜â€œå¿«ä¹çš„æ ‡é…,ç«é”…å’Œå§å¦¹",
    "ğ™„ğ™£ğ™©ğ™šğ™§ğ™šğ™¨ğ™©ğ™ğ™£ğ™œğŸ¤ğŸ£â€œåƒå¾—é¥±æƒ³çš„å°‘ å¤©å¤©å¼€å¿ƒæ²¡çƒ¦æ¼â€",
    "Ê”â€¢Í¡Ì«â€¢Ê•á¶ áµƒáµ— á¶ áµƒáµ— á¶ áµƒáµ—ğŸ¥©",
    "ä¸€å¹´å››å­£ï¼šæ˜¥è‚¥ å¤èƒ– ç§‹è†˜ å†¬åœ†",
    ": / ğ™ğ™¤ğ™¤ğ™™ğ™ğ™šğ™šğ™šğ™š ğ“€ ğ“€¤ğ“€¥ğ“€«",
    "â€˜â€˜ å®ğŸ””ï¼åŒä¸‹å·´ç»­è´¹æˆåŠŸ â€™â€™ğŸ¥¢",
    "ğ‘©ğ’‚ğ’“ğ’ƒğ’†ğ’„ğ’–ğ’† / ğŸ¥“ğŸ¥˜",
    "æŠŠçœ¼ç›ç•™ç»™é£æ™¯ æŠŠä½“é‡ç•™ç»™ç¾é£Ÿ",
    "â˜¾Ëšâ€§Âºæ°”æ°›éƒ½åˆ°è¿™äº† å‘ä¸ªæœ‹å‹åœˆå§ â¥âƒ",
    "Ë—Ë‹Ë ğŸ» ËËŠË—ğğšğ­ğ­ğ­ğ­â€¦è‚šå­å–‚é¥±â€¢å¯çˆ±åˆ°è€âŒ‡",
    "Ë—Ë‹Ë ğ—™ğ—¼ğ—¼ğ—±ğ—¶ğ—²ğŸ¥¯ğŸ¥¢ËËŠË—",
    "åˆ«å’Œä½“é‡æ–¤æ–¤è®¡è¾ƒ åƒå¾—å¼€å¿ƒå°±å¥½",
    "ğŸ¨ğŸ¯ä¸è¦æ€¥ å¥½åƒæ…¢å–æ¥æ—¥æ–¹é•¿ğŸ¥›",
    "ğŸ¥¢ğ‘»ğ’ğ’ˆğ’†ğ’•ğ’‰ğ’†ğ’“ğŸ‘«",
    "çˆ±åƒçš„å¥³å­©å­è¿æ°”ä¸ä¼šå·®Â·å› ä¸ºé£Ÿæ¥è¿è½¬ğŸ¥˜",
    "âœï¸ä»Šå¤©ä¾ç„¶æ˜¯ç¢Œç¢Œæ— ä¸ºçš„çŸ¥é£Ÿåˆ†å­",
    "à¥±à¬³åšä¸€æšå¿«ä¹çš„åƒè´§ğŸ¥§",
    ".âœ  FÃ¸Ã¸Ä‘  áµ•Ìˆ åƒå–å°æ—¥å¸¸",
    "â€œå°è‚š å°è‚šâ€ â€œ æˆ‘åœ¨ğŸ™‹ğŸ»â€â™‚â€",
    "*Êšâ—¡ÌˆâƒÉæ™šèƒ–ä¸å¦‚æ—©èƒ–",
    ": / ğ™ğ™¤ğ™¤ğ™™ğ™ğ™šğ™šğ™šğ™š ğ“€ ğ“€¤ğ“€¥ğ“€«",
    "â€˜â€˜ å®ğŸ””ï¼åŒä¸‹å·´ç»­è´¹æˆåŠŸ â€™â€™ğŸ¥¢",
    "äººç”Ÿå¹¸äº‹, å…«ä¹ä¸ç¦»é£Ÿ ğŸ±",
    "é—ºèœœğŸ‘­å°±æ˜¯ï¼šä¸€èµ·åƒé¥­ä¸€èµ·èƒ– â™¡Ì·ğŸ¹ğŸ§€ï¸ğŸ®ğŸ£ğŸ•",
    "å˜´å·´ä¸€å¼  ä¸‹å§å˜åŒ~`oËŠ~èµ°è¿›æ¼«ç”»é£çš„ä¸€å¤©",
    "ğ“Œ‰â—¯ğ“‡‹ ï¸ ä»Šæ—¥èœå•ğŸ“",
    "ğŸ¥˜âˆ™å’•å™œå’•å™œâ‘‰",
    "ğ… ğŸ”ğŸ” ğğğğğğğğğğğ",
    "æ°é£¯â—Ëƒáµ•Ë‚â—",
]

TEA_TITLE = [
    "ğŸ®ğŸŒˆğ–¬ğ–¾ğ–¾ğ—ğ—‚ğ—‡ğ—€â–¸ÊšğŸ°Éê™³â‹†ğŸœ\nğŸ¹Éâ‹†æ…µæ‡’ä¸‹åˆèŒ¶æ—¶å…‰â™¡ã‚›ğŸ¹",
    "ä½ æœ‰ä¸€ä»½ç”œç”œæ—¥å¸¸è¯·æŸ¥æ”¶~ğŸ°",
    "ä¸‹åˆèŒ¶ğ˜ğ—¶ğ—ºğ—²â‚Ë„Â·Íˆà¼Â·ÍˆË„*â‚â— Ì‘Ì‘â˜•",
    "â˜•ï¸ á´á´á´á´‡É´á´›é™è°§çš„ä¸‹åˆèŒ¶æ—¶å…‰",
    "æ²¡æœ‰æ–‡æ¡ˆ,åªæƒ³ç»­æ¯ğŸ¥¤",
    "ç”œèŒ¶è®°ğŸ“â•ğŸ°ğŸŸ°â˜•ï¸",
    "å·å¾—æµ®ç”ŸåŠæ—¥é—²,è½»ç…®å²æœˆæ…¢ç…®èŒ¶â˜•",
    "ğŸ“·ç›¸æœºé‡ŒåˆèŒ¶çš„å°ç¢ç‰‡â˜•",
    "ã€Œâ˜•ã€â–¸COFFEE TIME",
    "å’–å•¡ä¸€æ¯ç²¾ç¥ç™¾å€( ï½¥âŠï½¥âˆ)â˜•ï¸",
    "â€¢Íˆá´—â€¢Íˆâ¸â¸â¸ç”œå“æ²»æ„ˆä¸€åˆ‡ Ëá¿Ì¬Ë€",
    "áµ•Ìˆä¸‹åˆèŒ¶æ™‚é–“ğŸ¸ğŸ§ˆâ˜•ï¸",
    "ğŸ®Â·çƒ­é‡ğš‹ğš˜ğš˜ğš– ğšğšŠğš¢ğŸ’¥.áŸ",
    "ç‘äº†ä¸ªå¹¸â‹†âºâ˜•ï¸â™ªğŸ”–á¯¤ğŸ¤",
    "ğŸŒˆæˆ‘çš„å¿«ä¹å¤šå·´èƒºğŸ¹ğŸ¥§ğ“Œ‰ğ“‡‹",
    "ğŸ°â€¢á´—â€¢ğŸ¥„ä»åƒå°è›‹ç³•å¼€å§‹å¹¸ç¦â€§â‚ŠËš",
    "ğŸ®Â°â‚Š ç„¦ç³–å¸ƒä¸âŸ¢ğŸ¥šâ‚Šâ‹†ğŸ¥›Ëšâº ğŸ¯ à´’",
    "ğŸ°â€§Ë–âºğŸ§âºËš æ’­æ”¾å¹¸ç¦æ­£ç‰‡ğŸ§ˆğ“ˆ’ê™³â‹† ğŸ§",
    "ğŸ§ ğŸ¥‚ ğŸ‡­â€ŠğŸ‡¦â€ŠğŸ‡µâ€ŠğŸ‡µâ€ŠğŸ‡¾ ä¸‹åˆèŒ¶ï¸æ—¶å…‰ğŸ™‹â€â™€ï¸",
    "ğŸ¨ç”œé£Ÿé…æ–¹ï¼š50%å¿«ä¹+50%è„‚è‚ª ğ“‚‚ ğ“‹œ",
]

SNACK_TITLE = [
    "â€œå°å°é…’é…’ï¼Œç“¶ç“¶å®‰å®‰â€",
    "áµ•Ìˆ É´Éªá´„á´‡ ğŸ» áµ•Ìˆ\nâ€œä¸è´Ÿæ—¶å…‰ï¼Œä¸å‹ç›¸èšâ€\nğŸº(ËŠá—œË‹*)",
    "ğŸŒƒå¤œç”Ÿæ´»æ‰åˆšåˆšå¼€å§‹~ğŸ¥ \nå•¤é…’ğŸºçƒ§çƒ¤ğŸ—ä¸èƒ½å°‘ï¼",
    "ğŸ–Â· ä»Šæ—¥â˜‘",
    "ğŸ“·ï½œçƒ§çƒ¤ç¯‡",
    "å¤œå®µï½œè‡ªç”±ğŸ…±ï¸ğŸ…±ï¸ğ",
    "â€œæç‚¹å¤œå®µğŸ³ğŸ³ğŸ´ğŸºğŸ¦â€",
    "â€Íˆ â€œå¼€å¿ƒå°±è¦å’”Ì¾æ»‹Ì¾å’”Ì¾æ»‹Ì¾â€",
    "ğŸ¥“ % ä»ŠÂ·æ—¥Â·çƒ­Â·é‡ï¼š9Í†Ìº9Í†Ìº%Í†Ìº",
    "å¥½èƒ–å‹ ËƒÌ¶ÍˆğŸ½Ë‚Ì¶Íˆ",
    "Barbecue.ğŸ»ğŸ¢ğŸ—ğŸº",
    "å—ï½çƒ¤è‚‰æ»‹æ»‹ä¸Šçº¿ğŸ”¥",
    "ä¸²ä¸²ä¸è´µï¼Œä½†å¾ˆå¯¹èƒƒ",
    "ğŸ¦ªğŸ¤ğŸ¥“çƒ§çƒ¤å°±æ˜¯0.5æ…¢æ”¾çš„å¿«ä¹ğ—¶ğ—»ğ—´",
    "ğŸ¥“ :ğ™™ğ™–ğ™® Â²â°Â²â´â€½",
    "å¼€å¿ƒæœ‰å¥½å¤šç§ï¼Œç‡’çƒ¤æ˜¯ç¬¬ä¸€ç§ğŸ—ğŸ–ğŸŒ¯ğŸ¢ğŸ¡ğŸ†",
    "â€œæ»‹Ì¾æ»‹Ì¾æ»‹Ì¾ï¼Œå†’é¦™Í‚å‘³Í‚çš„å¤œé—´å¿«Íä¹Íâ€",
    "Êœáµƒáµ–áµ–áµ â€¢å¤šçƒ¤ä¸¤ä¸²ğŸ¡ğŸ¢âš˜",
    "ğŸ–ğ“‚‚ğ“ˆ’ğ“¸ â€œé¦™è¿·ç³Šäº†â€ğŸ˜›ğŸ’­",
    "ğŸºğŸ—çƒ§çƒ¤é…å•¤é…’âœ¿.",
    "çƒ§çƒ¤ğŸ±ğŸ¢ğŸ»",
    "á¶ áµƒáµ—ğŸ¯æ€»è¦ç•™ä¸‹é•¿è‚‰çš„è¯æ®Ë™ê™ªË™",
]

DELIM = [
    "â€”â€”â€”â€”Õâ€¢ãƒ»â€¢Õâ€”â€”â€”â€”",
    "â€”â€” à¸…Õâ€¢â€¢Õà¸…â™¥ â€”â€”",
    "â€”â€”â€”à¹‘áµ”â¤™áµ”à¹‘ â¸â¸â€”â€”â€”",
    "â€”â€”á¢â¸â¸ â€º ~ â€¹â¸â¸á¢â€”â€”",
    "â€”â€”â€”Ê•Â·Í¡Ë‘Â·à½»Ê” â€”â€”â€”",
    "â€”â€”â€”ğŸ¥¯Ë¶â•¹ê‡´â•¹Ë¶ğŸ¥¯â€”â€”â€”",
    "â€”â€”â€”â›Ë“â—Ë‚Ìµâœ§â€”â€”â€”",
    "ğŸ’®-â€”ğŸ®â€¢Ì€ÖŠâ€¢ÌğŸ®â€”-ğŸ’®",
]

LINK = "\n  ç‚¹å‡»é“¾æ¥é€‰åº—å•µ\nğŸ‘‰s.mrw.so/9K4AN"

MSG_HOLIDAY = "\n\nã€ç¾å›¢ğŸ§§ã€é“¾æ¥\nğŸ‘‰dpurl.cn/AvSbR2Fz\nã€é¥¿äº†ä¹ˆğŸ§§ã€é“¾æ¥\nğŸ‘‰u.ele.me/lZfkgmHt\nã€æ­ªéº¦ã€åº—é“ºå…¥å£\nğŸ‘‰s.mrw.so/9K4AN\n"


def is_within_date(start_date: str, end_date: str) -> bool:
    """
    åˆ¤æ–­å½“å‰æ—¥æœŸæ˜¯å¦åœ¨æ—¥æœŸèŒƒå›´å†…
    :param start_date: å¼€å§‹æ—¥æœŸ(1.22)
    :param end_date: ç»“æŸæ—¥æœŸ(2.5)
    :return: æ˜¯ä¸å¦
    """
    today = datetime.today()
    start_date = datetime.strptime(f"{today.year}.{start_date}", "%Y.%m.%d")
    end_date = datetime.strptime(f"{today.year}.{end_date}", "%Y.%m.%d")
    end_date += timedelta(days=1)

    return start_date <= today <= end_date


def redeem_code() -> str:
    """
    è¾“å‡ºä»Šæ—¥å…‘æ¢ç 
    :return: å…‘æ¢ç æ–‡æ¡ˆ
    """
    # å£ä»¤:[2025æ–°å¹´å¿«ä¹][æ­ªéº¦å®æ³¢][æ­ªéº¦å‘¨ä¸‰éœ¸ç‹æ—¥][2025è›‡å¹´å¤§å‰]
    code = "\n-------å…‘æ¢ä¸“åŒº-------"
    base_code = code  # è®°å½•åˆå§‹å†…å®¹ï¼Œé˜²æ­¢æ— æ„ä¹‰è¿”å›

    # åˆ¤æ–­ä»Šæ—¥æ˜¯å¦åœ¨æ—¥æœŸèŒƒå›´å†…
    if is_within_date("1.22", "2.5"):
        code += "\nğŸ®æ¬¢åº¦æ˜¥èŠ‚èµ¢å¥½ç¤¼ğŸ®\nğŸ‘‰æ–°å¹´å£ä»¤ï¼šæ‰“å¼€æ­ªéº¦APPğŸ“±-æˆ‘çš„-å…‘æ¢ä¸“åŒºè¾“å…¥-â€œ2025è›‡å¹´å¤§å‰â€é¢†å–14å¤©ä¼šå‘˜\nï¼ˆæœ‰æ•ˆæœŸï¼š1.22-2.5ï¼‰æŠ“ç´§æ—¶é—´å…‘æ¢å“¦ï¼"

    # åˆ¤æ–­ä»Šæ—¥æ˜¯å¦ä¸ºå‘¨ä¸‰ (wed)
    if datetime.today().weekday() == 2:
        code += "\nğŸŒŸæ­ªéº¦å‘¨ä¸‰ç‹‚æ¬¢é€3å¤©ä¼šå‘˜ğŸŒŸ\nğŸ‘‰æ‰“å¼€æ­ªéº¦APPï¼Œè¿›å…¥â€œæˆ‘çš„-å…‘æ¢ä¸“åŒºâ€ï¼Œè¾“å…¥å£ä»¤â€œæ­ªéº¦å‘¨ä¸‰éœ¸ç‹æ—¥â€å…‘æ¢ï¼"

    return code if code != base_code else ""


# å‘é€å¯¹è±¡åˆ—è¡¨
LISTEN_ATALL_LIST = [
    # "ä¼ è¾“åŠ©æ‰‹"
]
LISTEN_LIST = [
    # "ä¼ è¾“åŠ©æ‰‹"
    "åœ¨å®æ³¢0-5å…ƒåƒéœ¸ç‹é¤-A3",
    "ã€æ­ªéº¦ã€‘å®æ³¢0-5å…ƒåƒå¤–å–-A1",
    "ã€æ­ªéº¦ã€‘å®æ³¢0-5å…ƒåƒå¤–å–-A2",
    "ã€æ­ªéº¦ã€‘å®æ³¢0-5å…ƒåƒå¤–å–-A3",
    "ã€æ­ªéº¦ã€‘å®æ³¢0-5å…ƒåƒå¤–å–-A4",
    "ã€æ­ªéº¦ã€‘å®æ³¢0-5å…ƒåƒå¤–å–-A5",
    "ã€æ­ªéº¦ã€‘å®æ³¢0-5å…ƒåƒå¤–å–VIPç¾¤",
    "å®æ³¢æ­ªéº¦éœ¸ç‹é¤ç¦åˆ©ç¾¤002",
    "å®æ³¢æ­ªéº¦éœ¸ç‹é¤ç¦åˆ©ç¾¤003",
    "å®æ³¢æ­ªéº¦éœ¸ç‹é¤ç¦åˆ©ç¾¤004",
]

# è·å–picæ–‡ä»¶å¤¹ç»å¯¹è·¯å¾„
current_file_dir = Path(__file__).resolve().parent
pic_files = current_file_dir / "pic"


def is_file() -> bool:
    """
    åˆ¤æ–­result.xlsxæ–‡ä»¶æ˜¯å¦å­˜åœ¨
    :return: æ˜¯ä¸å¦
    """
    try:
        data_files = Path(current_file_dir) / "data" / "result.xlsx"
        return data_files.is_file()
    except OSError:
        return False


def random_image_path(folder_path: str) -> str | None:
    """
    éšæœºè¿”å›æŒ‡å®šæ–‡ä»¶å¤¹ä¸­çš„å›¾ç‰‡è·¯å¾„
    :param folder_path: æŒ‡å®šæ–‡ä»¶å¤¹è·¯å¾„
    :return: æŒ‡å®šæ–‡ä»¶å¤¹è·¯å¾„ä¸­çš„å›¾ç‰‡è·¯å¾„
    """
    # è·å–æ–‡ä»¶å¤¹è·¯å¾„å¯¹è±¡
    folder = Path(folder_path)

    # è·å–æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶(æŒ‡å®šæ ¼å¼)
    image_files = [
        f for f in folder.glob("*") if f.suffix in {".jpg", ".jpeg", ".png", ".bmp"}
    ]

    # å¦‚æœæ²¡æœ‰æ‰¾åˆ°å›¾ç‰‡æ–‡ä»¶,è¿”å›None
    if not image_files:
        return None

    # éšæœºé€‰æ‹©ä¸€å¼ å›¾ç‰‡å¹¶è¿”å›ç»å¯¹è·¯å¾„
    return str(random.choice(image_files))


def push_msg(msg_list: list, filepath: list[str | None]) -> None:
    """
    éå†å‘é€æ¶ˆæ¯
    :param msg_list: å‘é€æ¶ˆæ¯åˆ—è¡¨
    :param filepath: å‘é€æ–‡ä»¶è·¯å¾„åˆ—è¡¨
    :return:
    """
    # è·å–å¾®ä¿¡çª—å£å¯¹è±¡
    wx = WeChat()
    # åˆ‡æ¢åˆ°èŠå¤©é¡µé¢
    wx.SwitchToChat()
    for la in LISTEN_ATALL_LIST:
        for m in msg_list:
            wx.AtAll(msg=m, who=la)
            wx.SendFiles(filepath=filepath, who=la)
    for l in LISTEN_LIST:
        for m in msg_list:
            wx.SendMsg(msg=m, who=l)
            wx.SendFiles(filepath=filepath, who=l)


def push_breakfast() -> None:
    """
    æ¨é€æ—©é¤æ¶ˆæ¯
    :return:
    """
    today = datetime.now()
    if is_workday(today) & is_file():
        category = ["â¾¯ç²‰ç²¥åŒ…"]
        # æ¶ˆæ¯åˆ—è¡¨
        msg_list = [
            random.choice(BREAKFAST_TITLE)
            + "\n"
            + rand_shop(category)
            + "\n"
            + random.choice(DELIM)
            + LINK
            + redeem_code()
        ]
    else:
        msg_list = [
            random.choice(BREAKFAST_TITLE)
            + MSG_HOLIDAY
            + random.choice(DELIM)
            # + "\nğŸ“¢æ”¾å‡æœŸé—´ï¼Œç¾¤å†…æ— å€¼ç­äººå‘˜å“¦~æœ‰äº‹ğŸ‰‘appåœ¨çº¿è”ç³»å®¢æœæˆ–è‡´ç”µï¼š6url.cn/u7DXRxã€4008275517ã€‘"
            + "\nè®°å¾—åŠæ—¶å»æäº¤è®¢å•å“¦ï¼"
            + redeem_code()
        ]
    # æ–‡ä»¶åˆ—è¡¨
    filepath = [random_image_path(pic_files / "breakfast")]
    push_msg(msg_list, filepath)


def push_dinner() -> None:
    """
    æ¨é€æ­£é¤æ¶ˆæ¯
    :return:
    """
    today = datetime.now()
    if is_workday(today) & is_file():
        category = ["ç‰¹è‰²å°åƒ", "ä¸­é¤ä¾¿é¤", "â½•é”…å†’èœ", "å¼‚å›½æ–™ç†"]
        msg_list = [
            random.choice(DINNER_TITLE)
            + "\n"
            + rand_shop(category)
            + "\n"
            + random.choice(DELIM)
            + LINK
            + redeem_code()
        ]
    else:
        msg_list = [
            random.choice(DINNER_TITLE)
            + MSG_HOLIDAY
            + random.choice(DELIM)
            # + "\nğŸ“¢æ”¾å‡æœŸé—´ï¼Œç¾¤å†…æ— å€¼ç­äººå‘˜å“¦~æœ‰äº‹ğŸ‰‘appåœ¨çº¿è”ç³»å®¢æœæˆ–è‡´ç”µï¼š6url.cn/u7DXRxã€4008275517ã€‘"
            + "\nè®°å¾—åŠæ—¶å»æäº¤è®¢å•å“¦ï¼"
            + redeem_code()
        ]
    filepath = [random_image_path(pic_files / "dinner")]
    push_msg(msg_list, filepath)


def push_tea() -> None:
    """
    æ¨é€ä¸‹åˆèŒ¶æ¶ˆæ¯
    :return:
    """
    today = datetime.now()
    if is_workday(today) & is_file():
        category = ["æ°´æœæœåˆ‡", "å¥¶èŒ¶ç”œç‚¹", "å’–å•¡"]
        msg_list = [
            random.choice(TEA_TITLE)
            + "\n"
            + rand_shop(category)
            + "\n"
            + random.choice(DELIM)
            + LINK
            + redeem_code()
        ]
    else:
        msg_list = [
            random.choice(TEA_TITLE)
            + MSG_HOLIDAY
            + random.choice(DELIM)
            # + "\nğŸ“¢æ”¾å‡æœŸé—´ï¼Œç¾¤å†…æ— å€¼ç­äººå‘˜å“¦~æœ‰äº‹ğŸ‰‘appåœ¨çº¿è”ç³»å®¢æœæˆ–è‡´ç”µï¼š6url.cn/u7DXRxã€4008275517ã€‘"
            + "\nè®°å¾—åŠæ—¶å»æäº¤è®¢å•å“¦ï¼"
            + redeem_code()
        ]
    filepath = [random_image_path(pic_files / "afternoontea")]
    push_msg(msg_list, filepath)


def push_snack() -> None:
    """
    æ¨é€å®µå¤œæ¶ˆæ¯
    :return:
    """
    today = datetime.now()
    if is_workday(today) & is_file():
        category = ["ç‰¹è‰²å°åƒ", "å…¶ä»–", "çƒ§çƒ¤å¤œå®µ", "å¼‚å›½æ–™ç†"]
        msg_list = [
            random.choice(SNACK_TITLE)
            + "\n"
            + rand_shop(category)
            + "\n"
            + random.choice(DELIM)
            + LINK
            + "\nğŸ””å®µå¤œè®¢å•è®°å¾—è¦æäº¤å“¦~~"
            + redeem_code()
        ]
    else:
        msg_list = [
            random.choice(SNACK_TITLE)
            + MSG_HOLIDAY
            + random.choice(DELIM)
            # + "\nğŸ“¢æ”¾å‡æœŸé—´ï¼Œç¾¤å†…æ— å€¼ç­äººå‘˜å“¦~æœ‰äº‹ğŸ‰‘appåœ¨çº¿è”ç³»å®¢æœæˆ–è‡´ç”µï¼š6url.cn/u7DXRxã€4008275517ã€‘"
            + "\nè®°å¾—åŠæ—¶å»æäº¤è®¢å•å“¦ï¼"
            + redeem_code()
        ]
    filepath = [random_image_path(pic_files / "snack")]
    push_msg(msg_list, filepath)


def push_activity() -> None:
    """
    æ¨é€æ´»åŠ¨æ¶ˆæ¯
    :return:
    """
    msg_list = [
        "ğŸ‰è›‡å¹´å¼€é—¨çº¢ï¼Œé‚€å¥½å‹èµšä¸åœï¼ğŸ\n\n1ï¸âƒ£ é‚€3äººé¦–å•ï¼Œå¥–åŠ±15å…ƒï¼\n2ï¸âƒ£ é‚€7äººé¦–å•ï¼Œå¥–åŠ±40å…ƒï¼\n3ï¸âƒ£ é‚€10äººé¦–å•ï¼Œå¥–åŠ±60å…ƒï¼\n\nğŸ‰è›‡å¹´ç‹‚æ¬¢ï¼Œé‚€è¯·è¶Šå¤šï¼Œå¥–åŠ±è¶Šé«˜ï¼Œå¿«æ¥èµšçº¢åŒ…ï¼ğŸ§§\n"
        + random.choice(DELIM)
        + "\nğŸ‘‰æ´»åŠ¨å…¥å£ï¼šs.mrw.so/9K4AN"
    ]
    filepath = [
        pic_files / "activity.jpg",
        pic_files / "guide.png",
    ]
    push_msg(msg_list, filepath)


if __name__ == "__main__":

    # push_breakfast()
    # push_dinner()
    # push_tea()
    # push_snack()
    # push_activity()

    # å®šæ—¶æ‰§è¡Œä»»åŠ¡
    schedule.every().day.at("08:00:00").do(push_breakfast)
    schedule.every().day.at("10:15:00").do(push_dinner)
    # schedule.every().day.at("10:30:00").do(push_activity)
    schedule.every().day.at("14:00:00").do(push_tea)
    schedule.every().day.at("16:30:00").do(push_dinner)
    # schedule.every().day.at("17:00:00").do(push_activity)
    schedule.every().day.at("20:00:00").do(push_snack)

    while True:
        schedule.run_pending()
        time.sleep(1)
